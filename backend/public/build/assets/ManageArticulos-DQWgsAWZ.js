import{_ as w,E as N}from"./app-BHOrBh52.js";import{B as E,a5 as y,m as o,E as t,a6 as D,G as n,a0 as x,I as s}from"./vue-Dp34GT9d.js";import"./vuetify-HETxidax.js";const U={data(){return{dialog:!1,dialogoAumento:!1,confirmDeleteDialog:!1,isEdit:!1,articuloAEliminar:null,porcentajeAumento:0,searchNombre:"",searchNumero:"",form:{id:null,numero:"",nombre:"",precio:0,costo_original:0},articulos:[],headers:[{title:"Número",key:"numero"},{title:"Nombre",key:"nombre"},{title:"Precio",key:"precio"},{title:"Costo Original",key:"costo_original"},{title:"Efectivo",key:"precio_efectivo"},{title:"Transferencia",key:"precio_transferencia"},{title:"Acciones",key:"actions",align:"center",sortable:!1}]}},computed:{articulosFiltrados(){const a=this.searchNombre.toLowerCase().split(" ").filter(d=>d.trim()!==""),e=this.searchNumero.toLowerCase().trim();return this.articulos.filter(d=>{const g=d.nombre.toLowerCase(),l=String(d.numero).toLowerCase(),i=a.every(p=>g.includes(p)),m=e===""||l.includes(e);return i&&m})}},created(){this.fetchArticulos()},methods:{async exportarExcel(){const a=new N.Workbook,e=a.addWorksheet("Artículos");e.columns=[{header:"Número",key:"numero",width:15},{header:"Nombre",key:"nombre",width:40},{header:"Precio",key:"precio",width:15},{header:"Costo Original",key:"costo_original",width:20},{header:"Efectivo",key:"efectivo",width:15},{header:"Transferencia",key:"transferencia",width:20}],this.articulosFiltrados.forEach(i=>{e.addRow({numero:i.numero,nombre:i.nombre,precio:i.precio,costo_original:i.costo_original,efectivo:i.precio_efectivo,transferencia:i.precio_transferencia})});const d=await a.xlsx.writeBuffer(),g=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=document.createElement("a");l.href=URL.createObjectURL(g),l.download="articulos.xlsx",l.click()},fetchArticulos(){axios.get("/articulos").then(a=>{this.articulos=a.data})},openAddDialog(){this.isEdit=!1,this.form={id:null,numero:"",nombre:"",precio:0,costo_original:0},this.dialog=!0},openEditDialog(a){this.isEdit=!0,this.form={...a},this.dialog=!0},saveArticulo(){if(!this.validateForm())return;this.form.precio=parseInt(this.form.precio),this.form.costo_original=parseInt(this.form.costo_original),(this.isEdit?axios.put(`/articulo/${this.form.id}`,this.form):axios.post("/articulo",this.form)).then(()=>{this.fetchArticulos(),this.dialog=!1})},openDeleteConfirm(a){this.articuloAEliminar=a,this.confirmDeleteDialog=!0},deleteArticulo(){axios.delete(`/articulo/${this.articuloAEliminar.id}`).then(()=>{this.fetchArticulos(),this.confirmDeleteDialog=!1})},recalcularPrecios(){axios.put("/articulos/recalcular-precios").then(()=>{this.fetchArticulos(),alert("Precios recalculados correctamente.")})},abrirDialogoAumento(){this.porcentajeAumento=0,this.dialogoAumento=!0},aumentarCostos(){axios.put("/articulos/aumentar-costos",{porcentaje:this.porcentajeAumento}).then(()=>{this.fetchArticulos(),this.dialogoAumento=!1,alert("Costos actualizados correctamente.")})},validateForm(){return!(!this.form.numero||String(this.form.numero).trim()===""||!this.form.nombre||this.form.nombre.trim()===""||!this.form.precio||isNaN(this.form.precio)||!this.form.costo_original||isNaN(this.form.costo_original))}}};function j(a,e,d,g,l,i){const m=s("v-col"),p=s("v-row"),c=s("v-text-field"),f=s("v-icon"),u=s("v-btn"),C=s("v-data-table"),b=s("v-card-title"),_=s("v-card-text"),k=s("v-card-actions"),v=s("v-card"),A=s("v-dialog"),h=s("v-form");return E(),y("div",null,[o(p,null,{default:t(()=>[o(m,null,{default:t(()=>e[12]||(e[12]=[D("h1",{class:"title font-weight-bold"},"Gestión de Artículos",-1)])),_:1})]),_:1}),o(p,{class:"d-flex mb-2"},{default:t(()=>[o(m,{cols:"12",sm:"6",md:"4"},{default:t(()=>[o(c,{modelValue:l.searchNombre,"onUpdate:modelValue":e[0]||(e[0]=r=>l.searchNombre=r),label:"Buscar por nombre",dense:"",solo:"",clearable:""},null,8,["modelValue"])]),_:1}),o(m,{cols:"12",sm:"6",md:"4"},{default:t(()=>[o(c,{modelValue:l.searchNumero,"onUpdate:modelValue":e[1]||(e[1]=r=>l.searchNumero=r),label:"Buscar por número",dense:"",solo:"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),o(p,{class:"d-flex align-center mb-4"},{default:t(()=>[o(m,{cols:"auto"},{default:t(()=>[o(u,{color:"black",onClick:i.openAddDialog},{default:t(()=>[o(f,{left:""},{default:t(()=>e[13]||(e[13]=[n("mdi-plus-box")])),_:1}),e[14]||(e[14]=n(" Agregar Artículo "))]),_:1},8,["onClick"])]),_:1}),o(m,{cols:"auto"},{default:t(()=>[o(u,{color:"primary",onClick:i.recalcularPrecios},{default:t(()=>[o(f,{left:""},{default:t(()=>e[15]||(e[15]=[n("mdi-currency-usd")])),_:1}),e[16]||(e[16]=n(" Recalcular Precios "))]),_:1},8,["onClick"])]),_:1}),o(m,{cols:"auto"},{default:t(()=>[o(u,{color:"green",onClick:i.abrirDialogoAumento},{default:t(()=>[o(f,{left:""},{default:t(()=>e[17]||(e[17]=[n("mdi-percent")])),_:1}),e[18]||(e[18]=n(" Aumentar Costos "))]),_:1},8,["onClick"])]),_:1}),o(m,{cols:"auto"},{default:t(()=>[o(u,{color:"orange",class:"ml-2",onClick:i.exportarExcel},{default:t(()=>[o(f,{left:""},{default:t(()=>e[19]||(e[19]=[n("mdi-download")])),_:1}),e[20]||(e[20]=n(" Exportar Excel "))]),_:1},8,["onClick"])]),_:1})]),_:1}),o(C,{headers:l.headers,items:i.articulosFiltrados,class:"elevation-1 mt-2",dense:""},{"item.actions":t(({item:r})=>[o(u,{flat:"",icon:"",onClick:V=>i.openEditDialog(r)},{default:t(()=>[o(f,{color:"black"},{default:t(()=>e[21]||(e[21]=[n("mdi-pencil-outline")])),_:1})]),_:2},1032,["onClick"]),o(u,{flat:"",icon:"",onClick:V=>i.openDeleteConfirm(r)},{default:t(()=>[o(f,{color:"black"},{default:t(()=>e[22]||(e[22]=[n("mdi-trash-can-outline")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]),o(A,{modelValue:l.dialogoAumento,"onUpdate:modelValue":e[4]||(e[4]=r=>l.dialogoAumento=r),"max-width":"400px"},{default:t(()=>[o(v,null,{default:t(()=>[o(b,null,{default:t(()=>e[23]||(e[23]=[n(" Aumentar Costos Originales ")])),_:1}),o(_,null,{default:t(()=>[o(c,{modelValue:l.porcentajeAumento,"onUpdate:modelValue":e[2]||(e[2]=r=>l.porcentajeAumento=r),label:"Porcentaje de aumento (%)",type:"number",required:""},null,8,["modelValue"])]),_:1}),o(k,null,{default:t(()=>[o(u,{text:"",onClick:e[3]||(e[3]=r=>l.dialogoAumento=!1)},{default:t(()=>e[24]||(e[24]=[n("Cancelar")])),_:1}),o(u,{color:"green",text:"",onClick:i.aumentarCostos},{default:t(()=>e[25]||(e[25]=[n(" Aplicar ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(A,{modelValue:l.dialog,"onUpdate:modelValue":e[11]||(e[11]=r=>l.dialog=r),"max-width":"600px"},{default:t(()=>[o(v,null,{default:t(()=>[o(b,{class:"d-flex justify-space-between align-center"},{default:t(()=>[n(x(l.isEdit?"Editar":"Agregar")+" Artículo ",1),o(u,{flat:"",icon:"",onClick:e[5]||(e[5]=r=>l.dialog=!1)},{default:t(()=>[o(f,{color:"red"},{default:t(()=>e[26]||(e[26]=[n("mdi-close")])),_:1})]),_:1})]),_:1}),o(_,null,{default:t(()=>[o(h,null,{default:t(()=>[o(c,{modelValue:l.form.numero,"onUpdate:modelValue":e[6]||(e[6]=r=>l.form.numero=r),label:"Número de Artículo",required:""},null,8,["modelValue"]),o(c,{modelValue:l.form.nombre,"onUpdate:modelValue":e[7]||(e[7]=r=>l.form.nombre=r),label:"Nombre de Artículo",required:""},null,8,["modelValue"]),o(c,{modelValue:l.form.precio,"onUpdate:modelValue":e[8]||(e[8]=r=>l.form.precio=r),label:"Precio",type:"number",required:""},null,8,["modelValue"]),o(c,{modelValue:l.form.costo_original,"onUpdate:modelValue":e[9]||(e[9]=r=>l.form.costo_original=r),label:"Costo Original",type:"number",required:""},null,8,["modelValue"])]),_:1})]),_:1}),o(k,null,{default:t(()=>[o(u,{text:"",onClick:e[10]||(e[10]=r=>l.dialog=!1)},{default:t(()=>e[27]||(e[27]=[n("Cancelar")])),_:1}),o(u,{color:"black",text:"",onClick:i.saveArticulo},{default:t(()=>[n(x(l.isEdit?"Guardar":"Agregar"),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const L=w(U,[["render",j]]);export{L as default};
