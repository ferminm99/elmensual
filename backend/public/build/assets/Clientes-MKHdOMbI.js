import{_ as E}from"./app-BHOrBh52.js";import{B as A,a5 as y,m as l,E as t,a6 as p,G as n,a0 as u,I as s}from"./vue-Dp34GT9d.js";import"./vuetify-HETxidax.js";const U={data(){return{dialog:!1,confirmDeleteDialog:!1,isEdit:!1,clienteAEliminar:null,search:"",valid:!0,form:{id:null,nombre:"",apellido:"",cuit:"",cbu:""},ventas:[],clientes:[],datosCargados:{clientes:!1,ventas:!1},headers:[{title:"Nombre",key:"nombre",sortable:!0},{title:"Apellido",key:"apellido",sortable:!0},{title:"CUIT",key:"cuit",sortable:!0},{title:"CBU",key:"cbu"},{title:"Total Ventas",key:"totalVentas",sortable:!0},{title:"Total Pagado",key:"totalPago",sortable:!0},{title:"Acciones",key:"actions",align:"center",sortable:!1}]}},created(){this.fetchClientes(),this.fetchVentas()},methods:{fetchClientes(){return axios.get("/clientes/listar").then(a=>{this.clientes=a.data||[],this.datosCargados.clientes=!0,this.verificarYCalcularTotales()})},fetchVentas(){return axios.get("/ventas/listar").then(a=>{this.ventas=a.data||[],this.datosCargados.ventas=!0,this.verificarYCalcularTotales()})},verificarYCalcularTotales(){this.datosCargados.clientes&&this.datosCargados.ventas&&this.calculateTotals()},calculateTotals(){this.clientes.forEach(a=>{a.totalVentas=0,a.totalPago=0}),this.ventas.forEach(a=>{const e=this.clientes.find(g=>g.id===a.cliente_id);e&&(e.totalVentas+=1,e.totalPago+=parseFloat(a.precio))})},formatCurrency(a){return a.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})},openAddDialog(){this.isEdit=!1,this.form={id:null,nombre:"",apellido:"",cuit:"",cbu:""},this.dialog=!0},openEditDialog(a){this.isEdit=!0,this.form={...a},this.dialog=!0},saveCliente(){if(!this.form.nombre||!this.form.apellido){alert("Por favor ingresa nombre y apellido.");return}this.form.nombre=this.capitalizarPalabras(this.form.nombre),this.form.apellido=this.capitalizarPalabras(this.form.apellido),this.isEdit?axios.put(`/cliente/${this.form.id}`,this.form).then(()=>{this.fetchClientes(),this.dialog=!1}):axios.post("/cliente",this.form).then(()=>{this.fetchClientes(),this.dialog=!1})},openDeleteConfirm(a){this.clienteAEliminar=a,this.confirmDeleteDialog=!0},deleteCliente(){axios.delete(`/cliente/${this.clienteAEliminar.id}`).then(()=>{this.fetchClientes(),this.confirmDeleteDialog=!1})},validateForm(){return this.form.nombre&&this.form.apellido&&this.form.cuit&&this.form.cbu},capitalizarPalabras(a){return a.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}}};function P(a,e,g,T,i,d){const v=s("v-col"),c=s("v-row"),m=s("v-text-field"),f=s("v-icon"),r=s("v-btn"),k=s("v-data-table"),C=s("v-card-title"),x=s("v-form"),b=s("v-card-text"),_=s("v-card-actions"),V=s("v-card"),h=s("v-dialog");return A(),y("div",null,[l(c,null,{default:t(()=>[l(v,null,{default:t(()=>e[12]||(e[12]=[p("h1",{class:"title font-weight-bold"},"Gestión de Clientes",-1)])),_:1})]),_:1}),l(c,{class:"mb-4"},{default:t(()=>[l(v,null,{default:t(()=>[l(m,{modelValue:i.search,"onUpdate:modelValue":e[0]||(e[0]=o=>i.search=o),label:"Buscar Cliente","append-icon":"mdi-magnify","single-line":"","hide-details":"",variant:"solo"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{class:"d-flex align-center mb-4"},{default:t(()=>[l(r,{color:"black",class:"ml-3",onClick:d.openAddDialog},{default:t(()=>[l(f,{left:""},{default:t(()=>e[13]||(e[13]=[n("mdi-plus-box")])),_:1}),e[14]||(e[14]=n(" Agregar Cliente "))]),_:1},8,["onClick"])]),_:1}),l(k,{headers:i.headers,items:i.clientes,search:i.search,class:"elevation-1 mt-2",dense:""},{"item.totalVentas":t(({item:o})=>[p("span",null,u(o.totalVentas||0),1)]),"item.totalPago":t(({item:o})=>[p("span",null,"$"+u(d.formatCurrency(o.totalPago||0)),1)]),"item.actions":t(({item:o})=>[l(r,{flat:"",icon:"",onClick:D=>d.openEditDialog(o)},{default:t(()=>[l(f,{color:"black"},{default:t(()=>e[15]||(e[15]=[n("mdi-pencil-outline")])),_:1})]),_:2},1032,["onClick"]),l(r,{flat:"",icon:"",onClick:D=>d.openDeleteConfirm(o)},{default:t(()=>[l(f,{color:"black"},{default:t(()=>e[16]||(e[16]=[n("mdi-trash-can-outline")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["headers","items","search"]),l(h,{modelValue:i.dialog,"onUpdate:modelValue":e[8]||(e[8]=o=>i.dialog=o),"max-width":"600px"},{default:t(()=>[l(V,null,{default:t(()=>[l(C,{class:"d-flex justify-space-between align-center"},{default:t(()=>[n(u(i.isEdit?"Editar":"Agregar")+" Cliente ",1),l(r,{flat:"",icon:"",onClick:e[1]||(e[1]=o=>i.dialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[17]||(e[17]=[n("mdi-close")])),_:1})]),_:1})]),_:1}),l(b,null,{default:t(()=>[l(x,{ref:"formCliente",modelValue:i.valid,"onUpdate:modelValue":e[6]||(e[6]=o=>i.valid=o),"lazy-validation":""},{default:t(()=>[l(m,{modelValue:i.form.nombre,"onUpdate:modelValue":e[2]||(e[2]=o=>i.form.nombre=o),label:"Nombre",required:"",rules:[o=>!!o||"Nombre es requerido"]},null,8,["modelValue","rules"]),l(m,{modelValue:i.form.apellido,"onUpdate:modelValue":e[3]||(e[3]=o=>i.form.apellido=o),label:"Apellido",required:"",rules:[o=>!!o||"Apellido es requerido"]},null,8,["modelValue","rules"]),l(m,{modelValue:i.form.cuit,"onUpdate:modelValue":e[4]||(e[4]=o=>i.form.cuit=o),label:"CUIT"},null,8,["modelValue"]),l(m,{modelValue:i.form.cbu,"onUpdate:modelValue":e[5]||(e[5]=o=>i.form.cbu=o),label:"CBU"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),l(_,null,{default:t(()=>[l(r,{text:"",onClick:e[7]||(e[7]=o=>i.dialog=!1)},{default:t(()=>e[18]||(e[18]=[n("Cancelar")])),_:1}),l(r,{color:"black",text:"",onClick:d.saveCliente},{default:t(()=>[n(u(i.isEdit?"Guardar":"Agregar"),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(h,{modelValue:i.confirmDeleteDialog,"onUpdate:modelValue":e[11]||(e[11]=o=>i.confirmDeleteDialog=o),"max-width":"400px"},{default:t(()=>[l(V,null,{default:t(()=>[l(C,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e[20]||(e[20]=n(" Confirmar eliminación ")),l(r,{flat:"",icon:"",onClick:e[9]||(e[9]=o=>i.confirmDeleteDialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[19]||(e[19]=[n("mdi-close")])),_:1})]),_:1})]),_:1}),l(b,null,{default:t(()=>[n(" ¿Estás seguro de que deseas eliminar al cliente "+u(i.clienteAEliminar.nombre)+" "+u(i.clienteAEliminar.apellido)+"? ",1)]),_:1}),l(_,null,{default:t(()=>[l(r,{text:"",onClick:e[10]||(e[10]=o=>i.confirmDeleteDialog=!1)},{default:t(()=>e[21]||(e[21]=[n("Cancelar")])),_:1}),l(r,{color:"red",text:"",onClick:d.deleteCliente},{default:t(()=>e[22]||(e[22]=[n("Eliminar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const q=E(U,[["render",P],["__scopeId","data-v-62bbe87e"]]);export{q as default};
