import{_ as U,E as B}from"./app-BHOrBh52.js";import{a4 as Q,B as h,a5 as S,m as l,E as t,a6 as x,a7 as w,G as i,D as j,a0 as g,I as m}from"./vue-Dp34GT9d.js";import"./vuetify-HETxidax.js";const F={data(){return{confirmDeleteDialog:!1,confirmAddDialog:!1,confirmFullDeleteDialog:!1,editDialog:!1,currentTalle:{marron:0,negro:0,verde:0,azul:0,celeste:0,blancobeige:0,talle:null},articulosCompletos:[],dialog:!1,selected:null,isAgregar:!0,selectedArticulo:null,selectedArticuloDialog:null,articulos:Q([]),talles:[],selectedTalles:[],tallesDisponiblesSeleccionados:[],tallesDisponibles:[{talle:0},{talle:2},{talle:4},{talle:6},{talle:8},{talle:10},{talle:12},{talle:14},{talle:16},{talle:32},{talle:34},{talle:36},{talle:38},{talle:40},{talle:42},{talle:44},{talle:46},{talle:48},{talle:50},{talle:52},{talle:54},{talle:56},{talle:58},{talle:60},{talle:62},{talle:64},{talle:66},{talle:68},{talle:70}],newQuantities:{verde:0,azul:0,marron:0,negro:0,celeste:0,blancobeige:0}}},created(){this.fetchArticulos()},computed:{headers(){return[{title:"Talle",key:"talle",align:"center"},{title:"Marrón",key:"marron",align:"center",sortable:!1,class:"marron-text"},{title:"Negro",key:"negro",sortable:!1,align:"center",class:"negro-text"},{title:"Verde",key:"verde",sortable:!1,align:"center",class:"verde-text"},{title:"Azul",key:"azul",sortable:!1,align:"center",class:"azul-text"},{title:this.esAlpargatas?"Rojo":"Celeste",key:"celeste",sortable:!1,align:"center",class:this.esAlpargatas?"rojo-text":"celeste-text"},{title:"Blanco/Beige",key:"blancobeige",sortable:!1,align:"center",headerClass:"blancobeige-text"},{title:"Total",key:"total_bombachas",align:"center"},{title:"Acciones",key:"actions",align:"center"}]},esAlpargatas(){const n=this.articulos.find(e=>e.id===this.selectedArticulo);return n?n.nombre.toUpperCase().includes("ALPARGATA"):!1}},methods:{exportarAExcel(){const n=new B.Workbook,e=n.addWorksheet("Bombachas");e.columns=[{header:"Artículo",key:"articulo",width:50},{header:"Talle",key:"talle",width:10},{header:"Marrón",key:"marron",width:10},{header:"Negro",key:"negro",width:10},{header:"Verde",key:"verde",width:10},{header:"Azul",key:"azul",width:10},{header:"Celeste",key:"celeste",width:10},{header:"Blanco/Beige",key:"blancobeige",width:15},{header:"Total",key:"total",width:10}];let b=null;this.articulosCompletos.forEach(d=>{const a=d.talles.filter(s=>s.marron>0||s.negro>0||s.verde>0||s.azul>0||s.celeste>0||s.blancobeige>0);a.length&&(b&&b!==d.numero&&e.addRow(["","","","","","","","",""]),a.forEach(s=>{const r=e.addRow({articulo:`${d.numero} - ${d.nombre}`,talle:s.talle,marron:s.marron,negro:s.negro,verde:s.verde,azul:s.azul,celeste:s.celeste,blancobeige:s.blancobeige,total:this.getTotalBombachas(s)});s.marron>0&&(r.getCell("marron").font={color:{argb:"8B4513"}}),s.negro>0&&(r.getCell("negro").font={color:{argb:"000000"}}),s.verde>0&&(r.getCell("verde").font={color:{argb:"228B22"}}),s.azul>0&&(r.getCell("azul").font={color:{argb:"0000FF"}}),s.celeste>0&&(r.getCell("celeste").font={color:{argb:"87CEEB"}}),s.blancobeige>0&&(r.getCell("blancobeige").font={color:{argb:"7A7A7A"}}),r.getCell("articulo").font={bold:!0,size:14}}),b=d.numero)}),n.xlsx.writeBuffer().then(d=>{const a=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download="listado_bombachas.xlsx",s.click()}),console.log("Exportación completada con ExcelJS")},openDeleteConfirm(n){this.talleAEliminar=n,this.confirmDeleteDialog=!0},openDeleteFullConfirm(n){this.talleAEliminar=n,this.confirmFullDeleteDialog=!0},openAddConfirm(){this.confirmAddDialog=!0},openEditDialog(n){this.currentTalle={...n},this.editDialog=!0},saveChanges(){axios.post(`/articulo/${this.selectedArticulo}/editar-bombachas`,{cantidades:{marron:this.currentTalle.marron,negro:this.currentTalle.negro,verde:this.currentTalle.verde,azul:this.currentTalle.azul,celeste:this.currentTalle.celeste,blancobeige:this.currentTalle.blancobeige},talle:this.currentTalle.talle}).then(n=>{console.log(n.data.message),this.editDialog=!1,this.fetchTalles()}).catch(n=>{console.error(n)})},openDialog(n){this.isAgregar=n==="agregar",this.dialog=!0},fetchArticulos(){fetch("/articulos/listar").then(n=>n.json()).then(n=>{this.articulos=n,console.log(this.articulos)}),fetch("/articulo/listar/talles").then(n=>n.json()).then(n=>{this.articulosCompletos=n})},onArticuloChange(){this.fetchTalles()},fetchTalles(){if(!this.selectedArticulo){console.error("No hay artículo seleccionado para obtener los talles");return}fetch(`/articulo/${this.selectedArticulo}`).then(n=>n.json()).then(n=>{this.talles=n.talles,console.log(this.talles)})},getTotalBombachas(n){return n.marron+n.negro+n.verde+n.azul+n.celeste+n.blancobeige},addQuantities(){this.selectedTalles.forEach(n=>{axios.post(`/articulo/${this.selectedArticuloDialog}/agregar-bombachas`,{cantidades:this.newQuantities,talle:n}).then(e=>{console.log(e.data.message),this.dialog=!1,this.confirmAddDialog=!1,this.fetchTalles(),this.resetQuantities()}).catch(e=>{console.error(e)})})},removeQuantities(){this.selectedTalles.forEach(n=>{axios.post(`/articulo/${this.selectedArticuloDialog}/eliminar-bombachas`,{cantidades:this.newQuantities,talle:n}).then(e=>{console.log(e.data.message),this.dialog=!1,this.confirmDeleteDialog=!1,this.fetchTalles(),this.resetQuantities()}).catch(e=>{console.error(e)})})},resetQuantities(){this.newQuantities={verde:0,azul:0,marron:0,negro:0,celeste:0,blancobeige:0},this.selectedTalles=[],this.selectedArticuloDialog=null},deleteCompleteTalle(){axios.post(`/articulo/${this.selectedArticulo}/eliminar-talle-completo`,{talle:this.talleAEliminar}).then(n=>{console.log(n.data.message),this.confirmFullDeleteDialog=!1,this.fetchTalles()}).catch(n=>{console.error(n)})},getRangoTalles(n){const e=n.match(/\d+/g);if(e&&e.length>=2){const b=parseInt(e[0],10),d=parseInt(e[1],10);return{minTalle:b,maxTalle:d}}return{minTalle:null,maxTalle:null}},tallesCorrectos(){this.selectedTalles=[],this.tallesDisponiblesSeleccionados=this.tallesDisponibles;const n=this.articulos.find(e=>e.id===this.selectedArticuloDialog);if(n){const{minTalle:e,maxTalle:b}=this.getRangoTalles(n.nombre);if(e!=null&&b!=null)if(n.nombre.toUpperCase().includes("ALPARGATA")){this.tallesDisponiblesSeleccionados=[];for(let d=e;d<=b;d++)this.tallesDisponiblesSeleccionados.push({talle:d})}else this.tallesDisponiblesSeleccionados=this.tallesDisponibles.filter(d=>d.talle>=e&&d.talle<=b&&d.talle%2===0);console.log(this.tallesDisponiblesSeleccionados)}},exportAndUploadToDrive(){axios.get("/google/callback").then(n=>{if(n.data.isAuthenticated)return axios.get("/upload-to-drive");window.location.href="/auth/google"}).then(n=>{console.log(n.data.message)}).catch(n=>{console.error(n)})}}},R={class:"marron-text"},N={class:"negro-text"},I={class:"verde-text"},G={class:"azul-text"},L={class:"blanco-text"},M={class:"headline"};function q(n,e,b,d,a,s){const r=m("v-col"),p=m("v-row"),T=m("v-autocomplete"),f=m("v-icon"),u=m("v-btn"),y=m("v-data-table"),v=m("v-card-title"),E=m("v-select"),c=m("v-text-field"),_=m("v-form"),A=m("v-card-text"),C=m("v-card-actions"),D=m("v-card"),V=m("v-dialog"),k=m("v-spacer");return h(),S("div",null,[l(p,null,{default:t(()=>[l(r,null,{default:t(()=>e[33]||(e[33]=[x("h2",{class:"text-h4"},"Inventario de Bombachas",-1)])),_:1})]),_:1}),l(p,null,{default:t(()=>[l(r,{cols:"12",md:"8"},{default:t(()=>[l(T,{modelValue:a.selectedArticulo,"onUpdate:modelValue":[e[0]||(e[0]=o=>a.selectedArticulo=o),s.onArticuloChange],items:a.articulos,"item-title":o=>`${o.numero} - ${o.nombre}`,"item-value":"id",label:"Selecciona un artículo",clearable:"",filterable:"",variant:"solo",class:w({"rojo-text":s.esAlpargatas})},null,8,["modelValue","items","item-title","onUpdate:modelValue","class"])]),_:1}),l(r,{cols:"12",md:"4",class:"d-flex justify-end"},{default:t(()=>[l(u,{color:"#6E7E8E",onClick:s.exportarAExcel,outlined:""},{default:t(()=>[l(f,{left:""},{default:t(()=>e[34]||(e[34]=[i("mdi-file-excel")])),_:1}),e[35]||(e[35]=i(" Exportar a Excel "))]),_:1},8,["onClick"]),l(u,{color:"#4A4A4A",onClick:s.exportAndUploadToDrive,class:"ml-2",outlined:""},{default:t(()=>[l(f,{left:""},{default:t(()=>e[36]||(e[36]=[i("mdi-google-drive")])),_:1}),e[37]||(e[37]=i(" Exportar y Subir a Drive "))]),_:1},8,["onClick"])]),_:1})]),_:1}),l(p,{class:"mt-4"},{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(u,{color:"#4A4A4A",onClick:e[1]||(e[1]=o=>s.openDialog("agregar")),outlined:""},{default:t(()=>[l(f,{left:""},{default:t(()=>e[38]||(e[38]=[i("mdi-plus")])),_:1}),e[39]||(e[39]=i(" Agregar Bombachas "))]),_:1}),l(u,{color:"#E57373",onClick:e[2]||(e[2]=o=>s.openDialog("eliminar")),class:"ml-2",outlined:""},{default:t(()=>[l(f,{left:""},{default:t(()=>e[40]||(e[40]=[i("mdi-delete")])),_:1}),e[41]||(e[41]=i(" Eliminar Bombachas "))]),_:1})]),_:1})]),_:1}),(h(),j(y,{key:a.selectedArticulo,headers:s.headers,items:a.talles,class:"elevation-1 mt-4"},{"item.marron":t(({item:o})=>[x("span",R,g(o.marron),1)]),"item.negro":t(({item:o})=>[x("span",N,g(o.negro),1)]),"item.verde":t(({item:o})=>[x("span",I,g(o.verde),1)]),"item.azul":t(({item:o})=>[x("span",G,g(o.azul),1)]),"item.celeste":t(({item:o})=>[x("span",{class:w({"celeste-text":!s.esAlpargatas,"rojo-text":s.esAlpargatas})},g(o.celeste),3)]),"item.blancobeige":t(({item:o})=>[x("span",L,g(o.blancobeige),1)]),"item.total_bombachas":t(({item:o})=>[i(g(s.getTotalBombachas(o)),1)]),"item.actions":t(({item:o})=>[l(u,{flat:"",icon:"",onClick:z=>s.openEditDialog(o)},{default:t(()=>[l(f,{color:"#4A4A4A"},{default:t(()=>e[42]||(e[42]=[i("mdi-pencil-outline")])),_:1})]),_:2},1032,["onClick"]),l(u,{flat:"",icon:"",onClick:z=>s.openDeleteFullConfirm(o.talle)},{default:t(()=>[l(f,{color:"#E57373"},{default:t(()=>e[43]||(e[43]=[i("mdi-trash-can-outline")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])),l(V,{modelValue:a.dialog,"onUpdate:modelValue":e[14]||(e[14]=o=>a.dialog=o),"max-width":"600px"},{default:t(()=>[l(D,null,{default:t(()=>[l(v,{class:"d-flex justify-space-between align-center"},{default:t(()=>[x("span",M,g(a.isAgregar?"Agregar":"Eliminar")+" Bombachas al Artículo",1),l(u,{flat:"",icon:"",onClick:e[3]||(e[3]=o=>a.dialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[44]||(e[44]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(A,null,{default:t(()=>[l(_,{ref:"form"},{default:t(()=>[l(p,null,{default:t(()=>[l(T,{modelValue:a.selectedArticuloDialog,"onUpdate:modelValue":[e[4]||(e[4]=o=>a.selectedArticuloDialog=o),s.tallesCorrectos],items:a.articulos,"item-title":o=>`${o.numero} - ${o.nombre}`,"item-value":"id",label:"Selecciona un artículo",clearable:"",filterable:""},null,8,["modelValue","items","item-title","onUpdate:modelValue"])]),_:1}),l(p,null,{default:t(()=>[l(E,{modelValue:a.selectedTalles,"onUpdate:modelValue":e[5]||(e[5]=o=>a.selectedTalles=o),items:a.tallesDisponiblesSeleccionados,"item-title":"talle","item-value":"talle",label:"Selecciona los talles",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),l(p,null,{default:t(()=>[l(r,{cols:"4"},{default:t(()=>[l(c,{modelValue:a.newQuantities.verde,"onUpdate:modelValue":e[6]||(e[6]=o=>a.newQuantities.verde=o),label:"Verde",type:"number",class:"verde-text",min:"0"},null,8,["modelValue"])]),_:1}),l(r,{cols:"4"},{default:t(()=>[l(c,{modelValue:a.newQuantities.azul,"onUpdate:modelValue":e[7]||(e[7]=o=>a.newQuantities.azul=o),label:"Azul",type:"number",class:"azul-text",min:"0"},null,8,["modelValue"])]),_:1}),l(r,{cols:"4"},{default:t(()=>[l(c,{modelValue:a.newQuantities.marron,"onUpdate:modelValue":e[8]||(e[8]=o=>a.newQuantities.marron=o),label:"Marrón",type:"number",class:"marron-text",min:"0"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(r,{cols:"4"},{default:t(()=>[l(c,{modelValue:a.newQuantities.negro,"onUpdate:modelValue":e[9]||(e[9]=o=>a.newQuantities.negro=o),label:"Negro",type:"number",class:"negro-text",min:"0"},null,8,["modelValue"])]),_:1}),l(r,{cols:"4"},{default:t(()=>[l(c,{modelValue:a.newQuantities.celeste,"onUpdate:modelValue":e[10]||(e[10]=o=>a.newQuantities.celeste=o),label:"Celeste (rojo en alpargata)",type:"number",class:"celeste-text",min:"0"},null,8,["modelValue"])]),_:1}),l(r,{cols:"4"},{default:t(()=>[l(c,{modelValue:a.newQuantities.blancobeige,"onUpdate:modelValue":e[11]||(e[11]=o=>a.newQuantities.blancobeige=o),label:"Blanco/Beige",type:"number",class:"blancobeige-text",min:"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(C,null,{default:t(()=>[l(u,{text:"",onClick:e[12]||(e[12]=o=>a.dialog=!1)},{default:t(()=>e[45]||(e[45]=[i("Cancelar")])),_:1}),l(u,{color:"blue darken-1",text:"",onClick:e[13]||(e[13]=o=>a.isAgregar?s.openAddConfirm():s.openDeleteConfirm())},{default:t(()=>[i(g(a.isAgregar?"Agregar":"Eliminar"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(V,{modelValue:a.editDialog,"onUpdate:modelValue":e[23]||(e[23]=o=>a.editDialog=o),"max-width":"500px"},{default:t(()=>[l(D,null,{default:t(()=>[l(v,{class:"d-flex justify-space-between align-center"},{default:t(()=>[i("Editar Cantidades del Talle "+g(a.currentTalle.talle),1),l(u,{flat:"",icon:"",onClick:e[15]||(e[15]=o=>a.editDialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[46]||(e[46]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(A,null,{default:t(()=>[l(p,null,{default:t(()=>[l(r,{cols:"6"},{default:t(()=>[l(c,{label:"Marrón",modelValue:a.currentTalle.marron,"onUpdate:modelValue":e[16]||(e[16]=o=>a.currentTalle.marron=o),class:"marron-text"},null,8,["modelValue"])]),_:1}),l(r,{cols:"6"},{default:t(()=>[l(c,{label:"Negro",modelValue:a.currentTalle.negro,"onUpdate:modelValue":e[17]||(e[17]=o=>a.currentTalle.negro=o),class:"negro-text"},null,8,["modelValue"])]),_:1}),l(r,{cols:"6"},{default:t(()=>[l(c,{label:"Verde",modelValue:a.currentTalle.verde,"onUpdate:modelValue":e[18]||(e[18]=o=>a.currentTalle.verde=o),class:"verde-text"},null,8,["modelValue"])]),_:1}),l(r,{cols:"6"},{default:t(()=>[l(c,{label:"Azul",modelValue:a.currentTalle.azul,"onUpdate:modelValue":e[19]||(e[19]=o=>a.currentTalle.azul=o),class:"azul-text"},null,8,["modelValue"])]),_:1}),l(r,{cols:"6"},{default:t(()=>[l(c,{label:"Celeste",modelValue:a.currentTalle.celeste,"onUpdate:modelValue":e[20]||(e[20]=o=>a.currentTalle.celeste=o),class:"celeste-text"},null,8,["modelValue"])]),_:1}),l(r,{cols:"6"},{default:t(()=>[l(c,{label:"Blanco/Beige",modelValue:a.currentTalle.blancobeige,"onUpdate:modelValue":e[21]||(e[21]=o=>a.currentTalle.blancobeige=o),class:"blancobeige-text"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(C,null,{default:t(()=>[l(k),l(u,{color:"grey",text:"",onClick:e[22]||(e[22]=o=>a.editDialog=!1)},{default:t(()=>e[47]||(e[47]=[i("Cancelar")])),_:1}),l(u,{color:"black",text:"",onClick:s.saveChanges},{default:t(()=>e[48]||(e[48]=[i("Guardar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(V,{modelValue:a.confirmDeleteDialog,"onUpdate:modelValue":e[26]||(e[26]=o=>a.confirmDeleteDialog=o),"max-width":"400px"},{default:t(()=>[l(D,null,{default:t(()=>[l(v,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e[50]||(e[50]=i("Confirmar eliminación")),l(u,{flat:"",icon:"",onClick:e[24]||(e[24]=o=>a.confirmDeleteDialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[49]||(e[49]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(A,null,{default:t(()=>e[51]||(e[51]=[i("¿Estás seguro de que deseas eliminar esas bombachas? ?")])),_:1}),l(C,null,{default:t(()=>[l(k),l(u,{color:"grey",text:"",onClick:e[25]||(e[25]=o=>a.confirmDeleteDialog=!1)},{default:t(()=>e[52]||(e[52]=[i("Cancelar")])),_:1}),l(u,{color:"red",text:"",onClick:s.removeQuantities},{default:t(()=>e[53]||(e[53]=[i("Eliminar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(V,{modelValue:a.confirmFullDeleteDialog,"onUpdate:modelValue":e[29]||(e[29]=o=>a.confirmFullDeleteDialog=o),"max-width":"400px"},{default:t(()=>[l(D,null,{default:t(()=>[l(v,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e[55]||(e[55]=i("Confirmar eliminación")),l(u,{flat:"",icon:"",onClick:e[27]||(e[27]=o=>a.confirmFullDeleteDialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[54]||(e[54]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(A,null,{default:t(()=>[i("¿Estás seguro de que deseas eliminar todas las bombachas de este talle "+g(n.talleAEliminar)+"?",1)]),_:1}),l(C,null,{default:t(()=>[l(k),l(u,{color:"grey",text:"",onClick:e[28]||(e[28]=o=>a.confirmFullDeleteDialog=!1)},{default:t(()=>e[56]||(e[56]=[i("Cancelar")])),_:1}),l(u,{color:"red",text:"",onClick:s.deleteCompleteTalle},{default:t(()=>e[57]||(e[57]=[i("Eliminar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(V,{modelValue:a.confirmAddDialog,"onUpdate:modelValue":e[32]||(e[32]=o=>a.confirmAddDialog=o),"max-width":"400px"},{default:t(()=>[l(D,null,{default:t(()=>[l(v,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e[59]||(e[59]=i("Confirmar adición")),l(u,{flat:"",icon:"",onClick:e[30]||(e[30]=o=>a.confirmAddDialog=!1)},{default:t(()=>[l(f,{color:"red"},{default:t(()=>e[58]||(e[58]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(A,null,{default:t(()=>e[60]||(e[60]=[i("¿Estás seguro de que deseas agregar estas bombachas?")])),_:1}),l(C,null,{default:t(()=>[l(k),l(u,{color:"grey",text:"",onClick:e[31]||(e[31]=o=>a.confirmAddDialog=!1)},{default:t(()=>e[61]||(e[61]=[i("Cancelar")])),_:1}),l(u,{color:"green",text:"",onClick:s.addQuantities},{default:t(()=>e[62]||(e[62]=[i("Agregar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const H=U(F,[["render",q],["__scopeId","data-v-7cd745cd"]]);export{H as default};
