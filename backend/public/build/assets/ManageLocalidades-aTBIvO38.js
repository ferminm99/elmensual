import{_ as y,E as D}from"./app-BHOrBh52.js";import{a5 as N,m as o,E as l,I as t,B,G as n,a0 as u}from"./vue-Dp34GT9d.js";import"./vuetify-HETxidax.js";function b(a){return a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}const U={data(){return{dialog:!1,isEdit:!1,localidades:[],search:"",form:{id:null,nombre:"",disponibilidad:!1},headers:[{title:"Nombre",key:"nombre"},{title:"Disponibilidad",key:"disponibilidad"},{title:"Acciones",key:"actions",sortable:!1,align:"end"}]}},computed:{localidadesFiltradas(){const a=b(this.search).split(" ").filter(Boolean);return this.localidades.filter(e=>a.every(c=>b(e.nombre).includes(c)))}},created(){this.fetchLocalidades()},methods:{fetchLocalidades(){axios.get("/api/localidades").then(a=>{console.log("PREPARANDO:"),this.localidades=a.data})},openDialog(){this.isEdit=!1,this.form={id:null,nombre:"",disponibilidad:!1},this.dialog=!0},editLocalidad(a){this.isEdit=!0,this.form={...a},this.dialog=!0},saveLocalidad(){(this.isEdit?axios.put(`/localidad/${this.form.id}`,this.form):axios.post("/localidad",this.form)).then(()=>{this.dialog=!1,this.fetchLocalidades()})},deleteLocalidad(a){confirm("¿Eliminar esta localidad?")&&axios.delete(`/localidad/${a}`).then(()=>this.fetchLocalidades())},async exportarExcel(){const a=new D.Workbook,e=a.addWorksheet("Localidades");e.columns=[{header:"Nombre",key:"nombre",width:30},{header:"Disponibilidad",key:"disponibilidad",width:20}],this.localidadesFiltradas.forEach(s=>{e.addRow({nombre:s.nombre,disponibilidad:s.disponibilidad?"Sí":"No"})});const c=await a.xlsx.writeBuffer(),p=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=document.createElement("a");i.href=URL.createObjectURL(p),i.download="localidades.xlsx",i.click()}}};function A(a,e,c,p,i,s){const _=t("v-text-field"),f=t("v-col"),r=t("v-btn"),m=t("v-icon"),v=t("v-row"),h=t("v-chip"),x=t("v-data-table"),k=t("v-card-title"),g=t("v-switch"),E=t("v-card-text"),w=t("v-card-actions"),L=t("v-card"),C=t("v-dialog");return B(),N("div",null,[o(v,{class:"mb-3"},{default:l(()=>[o(f,{cols:"12",md:"4"},{default:l(()=>[o(_,{modelValue:i.search,"onUpdate:modelValue":e[0]||(e[0]=d=>i.search=d),label:"Buscar localidad",solo:"",dense:"",clearable:""},null,8,["modelValue"])]),_:1}),o(f,{cols:"auto"},{default:l(()=>[o(r,{color:"primary",onClick:s.openDialog},{default:l(()=>e[5]||(e[5]=[n("Agregar Localidad")])),_:1},8,["onClick"])]),_:1}),o(f,{cols:"auto"},{default:l(()=>[o(r,{color:"orange",onClick:s.exportarExcel},{default:l(()=>[o(m,{left:""},{default:l(()=>e[6]||(e[6]=[n("mdi-download")])),_:1}),e[7]||(e[7]=n(" Exportar Excel "))]),_:1},8,["onClick"])]),_:1})]),_:1}),o(x,{headers:i.headers,items:s.localidadesFiltradas,dense:""},{"item.disponibilidad":l(({item:d})=>[o(h,{color:d.disponibilidad?"green lighten-4":"red lighten-4"},{default:l(()=>[o(m,{left:""},{default:l(()=>[n(u(d.disponibilidad?"mdi-check-circle":"mdi-close-circle"),1)]),_:2},1024),n(" "+u(d.disponibilidad?"Disponible":"No disponible"),1)]),_:2},1032,["color"])]),"item.actions":l(({item:d})=>[o(r,{icon:"",onClick:V=>s.editLocalidad(d)},{default:l(()=>[o(m,null,{default:l(()=>e[8]||(e[8]=[n("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),o(r,{icon:"",onClick:V=>s.deleteLocalidad(d.id)},{default:l(()=>[o(m,{color:"red"},{default:l(()=>e[9]||(e[9]=[n("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]),o(C,{modelValue:i.dialog,"onUpdate:modelValue":e[4]||(e[4]=d=>i.dialog=d),"max-width":"500px"},{default:l(()=>[o(L,null,{default:l(()=>[o(k,null,{default:l(()=>[n(u(i.isEdit?"Editar":"Agregar")+" Localidad",1)]),_:1}),o(E,null,{default:l(()=>[o(_,{modelValue:i.form.nombre,"onUpdate:modelValue":e[1]||(e[1]=d=>i.form.nombre=d),label:"Nombre"},null,8,["modelValue"]),o(g,{modelValue:i.form.disponibilidad,"onUpdate:modelValue":e[2]||(e[2]=d=>i.form.disponibilidad=d),label:"Disponible"},null,8,["modelValue"])]),_:1}),o(w,null,{default:l(()=>[o(r,{text:"",onClick:e[3]||(e[3]=d=>i.dialog=!1)},{default:l(()=>e[10]||(e[10]=[n("Cancelar")])),_:1}),o(r,{color:"primary",onClick:s.saveLocalidad},{default:l(()=>e[11]||(e[11]=[n("Guardar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const q=y(U,[["render",A],["__scopeId","data-v-7ecfc2f5"]]);export{q as default};
